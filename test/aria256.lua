local aria = require "luasec.src.aria256"
local bit = require "bit"
local hex = bit.tohex

local crypt = aria.new(
    0x00010203, 0x04050607, 
    0x08090a0b, 0x0c0d0e0f,
    0x10111213, 0x14151617,
    0x18191a1b, 0x1c1d1e1f
)
print("Key: 000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f")
print("------------------------------------------------------------------")
local a, b, c, d = 0x00112233, 0x44556677, 0x8899aabb, 0xccddeeff
print("------------------------------------------------------------------")
print("Before: ", hex(a), hex(b), hex(c), hex(d))
print("------------------------------------------------------------------")
a, b, c, d = crypt:encrypt(a, b, c, d)
print("------------------------------------------------------------------")
print("After: \t", hex(a), hex(b), hex(c), hex(d))
print("------------------------------------------------------------------")
a, b, c, d = crypt:decrypt(a, b, c, d)
print("------------------------------------------------------------------")
print("Decrypted: ", hex(a), hex(b), hex(c), hex(d))
print("------------------------------------------------------------------")